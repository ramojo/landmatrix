{% extends "charts/base_chart.html" %}{% load i18n static wagtailcore_tags  sass_tags %}

{% block page_title %}{% trans "Perspective" %}{% endblock %}
{% block title %}{% trans "Perspective" %}{% endblock %}
{% block breadcrumb_inner %}
    {{ block.super }}
    <li>{% trans "Perspective" %}</li>
{% endblock %}

<link rel="stylesheet" href="{% static "vendor/openlayers/ol.css" %}"/>
<link rel="stylesheet" href="{% static "css/ol3-layerswitcher.css" %}"/>


<link rel="stylesheet" href="{% static "css/nprogress.css" %}"/>
<!-- <link rel="stylesheet" href="{% static "css/map.css" %}"/> -->
<link href="{% sass_src 'css/map.scss' %}" rel="stylesheet" type="text/css" />


<div id="alert_placeholder"></div>

{% block description %}
    {{ block.super }}
    <div class="input-group col-md-6" role="group">
        <input id="search" class="location form-control" name="location" type="search" value="" placeholder="{%  trans 'Enter location...' %}"/>
        <span class="input-group-btn">
            <button type="submit" class="btn btn-default">{% trans "Go" %}</button>
        </span>
    </div>
{% endblock %}

{% block data_availability %}{% endblock %}

{% block legend %}
    <ul class="media-list legend offset bigdeal">
        <li><i class="icon icon-none" style="background-color: #ed881b;"></i>{% trans 'Area equal to the size of the intended, concluded or failed land acquisitions (<span class="hectares">0</span> ha)' %}</li>
    </ul>
{% endblock %}

{% block data %}
    <div id="map" class="map" title='{% trans "Perspective" %}'></div>

<div id="popup" class="ol-popup">
    <a href="#" id="popup-closer" class="noul ol-popup-closer"></a>
    <div id="popup-content"></div>
</div>

{% endblock data %}



{% block after %}
{{ block.super }}
<script type="text/javascript">
    var mapShowPerspective = true;

            /*mapBounds = [
                {{ country.point_lat_min }}, {{ country.point_lon_min }},
                {{ country.point_lat_max }}, {{ country.point_lon_max }},
            ];*/
$(document).ready(function () {
    initGeocoder(document.getElementById("search"));

    function updateBigDealData() {
        var json_query = "/api/hectares.json";
        jQuery.getJSON(json_query, function (data) {
            bigdealArea = parseFloat(data["hectares"]);

            // Update legend
            $(".legend li .hectares").text(number_format(circle_hectares, 0));
            drawCircleInMeter();
        });
    }

    console.log('Drawing big deal.');

    updateBigDealData();

});
</script>


<script type="text/javascript" src="{% static "vendor/openlayers/ol-debug.js" %}"></script>
<script type="text/javascript" src="{% static "js/ol3-layerswitcher.js" %}"></script>
<script type="text/javascript" src="{% static "vendor/nprogress/nprogress.js" %}"></script>

<script type="text/javascript" src="{% static "js/map.js" %}"></script>
<script type="text/javascript" src="{% static "js/layers.js" %}"></script>
<script type="text/javascript" src="{% static "js/main.js" %}"></script>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB59at4M4o0ERqk8OkvZOYjxH7N-8_HkNE&libraries=places"></script>

{% endblock %}

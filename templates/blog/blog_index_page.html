{% extends "base.html" %}
{% load wagtailcore_tags static i18n %}

{% block page_title %}{{ self.title }}{% endblock %}
{% block title %}{{ self.title }}{% endblock %}

{% block content %}
    {% if category %}
    <h2>{{ category }}</h2>
    {% endif %}
    {% if tag %}
    <h2>{% trans "Posts tagged with" %} '{{ tag }}'</h2>
    {% endif %}

    {% for rl in self.related_links.all %}
        <p>{{ rl.title }}: <a href='{{ rl.link_page.url }}'>{{ rl.link_page }}</a></p>
    {% endfor %}

    {% if blogs %}
    <div class="row row-flex row-flex-wrap">
        {% for item in blogs %}
        <div class="col-sm-6 col-md-4">
          <div class="thumbnail flex-col">
            {% if item.header_image %}<img src="{{ item.header_image.file.url }}"/>{% endif %}
            <div class="caption">
              <h3><a href="{{ item.get_absolute_url }}">{{ item.title }}</a></h3>
              <p>{{ item.body|richtext|truncatewords_html:50 }}</p>
              <p>
                <a href="{{ item.get_absolute_url }}" class="btn">{% trans "Read more" %}</a>
              </p>
            </div>
          </div>
        </div>
        {% endfor %}
        </div>

        <ul class="pager">
        {% if blogs.has_next %}
          <li class="previous"><a href="?page={{ blogs.next_page_number }}{% for key,value in request.GET.items %}{% ifnotequal key 'page' %}&amp;{{ key }}={{ value }}{% endifnotequal %}{% endfor %}">&larr; Older</a></li>
        {% endif %}
        {% if blogs.has_previous %}
          <li class="next"><a href="?page={{ blogs.previous_page_number }}{% for key,value in request.GET.items %}{% ifnotequal key 'page' %}&amp;{{ key }}={{ value }}{% endifnotequal %}{% endfor %}">Newer &rarr;</a></li>
        {% endif %}
        </ul>

    {% else %}
        <p>{% trans "There are currently no blog posts" %}</p>
    {% endif %}
{% endblock %}
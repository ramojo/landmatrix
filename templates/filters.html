{% load i18n custom_tags %}
{% load humanize %}

    <div class="row">
        <div class="col-md-10">
            <label>{% trans "Active Filters" %}:</label>
            <span class="label label-filter">{% trans "Negotiation status" %} <i class="lm lm-times"></i></span>
            <span class="label label-filter">{% trans "Deal scope" %} <i class="lm lm-times"></i></span>
            <span class="label label-filter">{% trans "Crops" %} <i class="lm lm-times"></i></span>
        </div>
        <div class="col-md-2 right">
            <a class="right toggle-filters" role="button" data-toggle="collapse" href="#filters" aria-expanded="true" data-toggle-text="{% trans "Hide filters" %}"
               aria-controls="filter-collapse">
                {% trans "Manage filters" %}
            </a>
        </div>
    </div>

    <div id="filters" class="clearfix collapse">
        <form>
            <div class="row">
                <div class="col-md-3 filterbox checkboxes">
                    <ul>
                        <li class="checkbox">
                            <input id="checkbox1" name="data1" type="checkbox">
                            <label for="checkbox1">{% trans "Concluded Deals" %}</label>
                        </li>
                        <li class="checkbox">
                            <input id="checkbox2" name="data2" type="checkbox">
                            <label for="checkbox2">{% trans "Intended Deals" %}</label>
                        </li>
                        <li class="checkbox">
                            <input id="checkbox3" name="data3" type="checkbox">
                            <label for="checkbox3">{% trans "Failed Deals" %}</label>
                        </li>
                        <li class="checkbox">
                            <input id="checkbox4" name="data4" type="checkbox">
                            <label for="checkbox4">{% trans "Exclude Media Reports" %}</label>
                        </li>
                    </ul>
                </div>
                <div class="col-md-3 filterbox no-pad">
                    <!-- <select id="filterselect" size="6" class="formcontrol">
                        <option value=""><strong style="backgroud-color: blue;">Spatial Data</strong></option>
                        <option value="">Location</option>
                        <option value=""><strong style="backgroud-color: blue;">General Info</strong></option>
                        <option value="">Current size under contract</option>
                        <option value="">Intention of the Investment</option>
                        <option value="">Nature of the deal</option>
                        <option value="">Negotiation Status</option>
                        <option value="">Implementation Status</option>
                    </select> -->
                    <ul class="variables">
                        <li>
                            <h4>{% trans "Spatial Data" %}</h4>
                            <ul>
                                <li><a href="#">{% trans "Location" %}</a></li>
                            </ul>
                        </li>
                        <li>
                            <h4>{% trans "General Info" %}</h4>
                            <ul>
                                <li><a href="#">{% trans "Current size under contract" %}</a></li>
                                <li><a href="#">{% trans "Intention of the Investment" %}</a></li>
                                <li><a href="#">{% trans "Nature of the deal" %}</a></li>
                                <li><a href="#">{% trans "Negotiation Status" %}</a></li>
                                <li><a href="#">{% trans "Implementation Status" %}</a></li>
                            </ul>
                        </li>
                    </ul>

                </div>
                <div class="col-md-6 filterbox">
                    <div class="input-group condition">
                        <select class="operator select-inline" value="Contains">
                            <option>Contains not</option>
                            <option>Equals</option>
                            <option>Equals not</option>
                            <option>Starts with</option>
                            <option>Ends with</option>
                        </select>
                        <input class="field" type="text" value="Foobar" class="inline">
                    </div>
                    <div class="input-group">
                        <button class="btn"><i class="lm lm-plus"></i> Add condition</button>
                    </div>
                </div>
            </div>
        </form>
    </div>

    <div id="filters_old" class="hidden">

        <script type="text/javascript">
            function init_form_condition(el) {
                // variable
                el.change(function () {
                    var form = $(this).parents("ul.form");
                    update_widget(form.find(".field:last .value-wrapper"), $(this).find("option:selected").val(), form);
                }).change();
                // operator
                el.parents("ul.form").find(".operator").change(function () {
                    el.change();
                });
                // delete button
                el.parents("ul.form").find(".delete-row").click(function () {
                    var form = $(this).parents("form"),
                            conditions = form.find(".condition:visible");
                    $(this).parents("ul.form.condition").remove();
                    var count = $("#id_{{ empty_form_conditions.prefix }}-TOTAL_FORMS").val() - 1;
                    $("#id_{{ empty_form_conditions.prefix }}-TOTAL_FORMS").val(count);
                    // reset row counters
                    var new_name;
                    for (var i = 0; i < count; i++) {
                        $(conditions[i]).find(":input").each(function () {
                            $(this).attr("id") && $(this).attr("id", $(this).attr("id").replace(/{{ empty_form_conditions.prefix }}-[0-9]+/, "{{ empty_form_conditions.prefix }}-" + i));
                            $(this).attr("name") && $(this).attr("name", $(this).attr("name").replace(/{{ empty_form_conditions.prefix }}-[0-9]+/, "{{ empty_form_conditions.prefix }}-" + i));
                        });
                        //el.parents("ul.form").find("li.field")
                    }
                });
            }

            $(document).ready(function () {
                // add sticky header to table
                var offset = $('.navbar').height();
                //$("#summary").stickyTableHeaders({fixedOffset: offset});
                // enable popover for intention of investment
                $('a.intention-icon').popover({trigger: "hover", placement: "top"});
                init_form_condition($("ul.form:not(.empty) .field:first-child select"));
                // collapsible filters
                //$(".toggle-filter").click(function (e) {
                //    e.preventDefault();
                //    $(".collapsible .collapsible-form").toggle();
                //    var container = $(".collapsible .collapsible-tags"),
                //            tags = container.find("ul");
                //    if (container.hasClass("collapsed")) {
                //        tags.empty();
                //        $(".form.condition:not(.empty)").each(function (index) {
                //            var tag = "";
                //            $(this).find(":input").each(function (index) {
                //                var el = $(this),
                //                        name = el.attr("name");
                //                if (name.indexOf("variable") > -1) {
                //                    // variable
                //                    tag += el.find(":selected").text();
                //                }
                //                /* requires update_widget to be executed before
                //                 else if (name.indexOf("operator") > -1) {
                //                 // operator
                //                 tag += " " + el.val();
                //                 // value (select)
                //                 } else if (el.is("select")) {
                //                 tag += " " + el.find(":selected").text();
                //                 // value (radio buttons)
                //                 } else if (el.is("[type=checkbox]")) {
                //                 tag += (tag.indexOf(",") > -1) && (" " + el.parent().text//()) || ", " + el.parent().text();
                //                 // value (other)
                //                 } else if (!el.is("[type=hidden]")) {
                //                 tag += " " + el.val();
                //                 }*/
                //            });
                //            tag = "<li><span class=\"label\">" + tag + "</span></li>";
                //            $(tag).appendTo(tags);
                //        });
                //        container.removeClass("collapsed");
                //        container.find(".toggle-filter").text("Manage filters");
                //        container.find(".toggle-tooltip").show();
                //    } else {
                //        container.addClass("collapsed");
                //        container.find(".toggle-filter").text("Hide filters");
                //        container.find(".toggle-tooltip").hide();
                //    }
                //    return false;
                //}).click();
                $('.toggle-filters').click(function () {
                    var text = $(this).data('toggle-text');
                    $(this).data('toggle-text', $(this).text()).text(text);
                })
            });
        </script> <!-- old filter javascript voodoo -->

    </div> <!-- old filter section -->
